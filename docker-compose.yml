version: '2'

services:
    db:
        build: ./docker/mysql
        volumes:
            - "../recruitment-task-katowice-db:/var/lib/mysql"
        image: mysql
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: symfony
            MYSQL_USER: user
            MYSQL_PASSWORD: user
        ports:
            - 4406:3306
        tty: true

    code:
        build: ./docker/code
        volumes:
            - .:/msales/recruitment-task-katowice
        tty: true

    php:
        container_name: recruitment-task-katowice-php
        build: ./docker/php7
        image: php-recruitment
        ports:
            - 9002:9001
        volumes_from:
            - code
        tty: true

    nginx:
        build: ./docker/nginx
        volumes:
            - ./logs/nginx/:/var/log/nginx
        ports:
            - 8082:80
        volumes_from:
            - code
        depends_on:
            - code
        tty: true

    sf:
        build: ./docker/sf
        volumes_from:
            - code
        depends_on:
            - php
        tty: true
            
    composer:
        build: ./docker/composer
        volumes_from:
            - code
        depends_on:
            - php
        tty: true
